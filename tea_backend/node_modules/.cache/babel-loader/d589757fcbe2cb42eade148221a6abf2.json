{"remainingRequest":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\babel-loader\\lib\\index.js!D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\food\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\food\\add.vue","mtime":1670920003115},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667713506232},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667713515975},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667713506232},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js","mtime":1667713514172}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _toConsumableArray from \"D:\\\\\\u5C1A\\u7845\\u8C37\\\\uniapp_storage\\\\tea_backend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.string.trim\";\nimport \"core-js/modules/es6.array.map\";\nimport _objectSpread from \"D:\\\\\\u5C1A\\u7845\\u8C37\\\\uniapp_storage\\\\tea_backend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\\\u5C1A\\u7845\\u8C37\\\\uniapp_storage\\\\tea_backend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { queryDishById } from \"../../api/food.js\";\nimport { getCategoryList } from \"../../api/food.js\";\nimport { addDish } from \"../../api/food.js\";\nimport { editDish } from \"../../api/food.js\";\nexport default {\n  name: 'fadd',\n  el: '#food-add-app',\n  data: function data() {\n    return {\n      id: '',\n      restKey: 0,\n      textarea: '',\n      value: '',\n      imageUrl: '',\n      actionType: '',\n      dishList: [],\n      dishFlavorsData: [],\n      dishFlavors: [],\n      vueRest: '1',\n      index: 0,\n      inputStyle: {\n        'flex': 1\n      },\n      ruleForm: {\n        'name': '',\n        'id': '',\n        'price': '',\n        'code': '',\n        'image': '',\n        'description': '',\n        'dishFlavors': [],\n        'status': true,\n        categoryId: ''\n      },\n      mak: false\n    };\n  },\n  computed: {\n    rules: function rules() {\n      return {\n        'name': [{\n          'required': true,\n          'message': '请填写菜品名称',\n          'trigger': 'blur'\n        }],\n        'categoryId': [{\n          'required': true,\n          'message': '请选择菜品分类',\n          'trigger': 'change'\n        }],\n        'price': [{\n          'required': true,\n          // 'message': '请填写菜品价格',\n          validator: function validator(rules, value, callback) {\n            if (!value) {\n              callback(new Error('请填写菜品价格'));\n            } else {\n              var reg = /^\\d+(\\.\\d{0,2})?$/;\n\n              if (reg.test(value)) {\n                if (value < 10000) {\n                  callback();\n                } else {\n                  callback(new Error('菜品价格小于10000'));\n                }\n              } else {\n                callback(new Error('菜品价格格式只能为数字,且最多保留两位小数'));\n              }\n            }\n          },\n          'trigger': 'blur'\n        }]\n      };\n    }\n  },\n  created: function created() {\n    this.$parent.goBackFlag = true;\n    this.$parent.menuActived = '4';\n    this.getDishList(); // 口味临时数据\n\n    this.getFlavorListHand();\n    this.id = this.$route.params.id;\n    console.log(\"-----------------\");\n    console.log(this.id);\n    this.actionType = this.id ? 'edit' : 'add';\n\n    if (this.id) {\n      this.init();\n    }\n  },\n  mounted: function mounted() {},\n  methods: {\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                queryDishById(this.id).then(function (res) {\n                  // console.log(\"12333333333333333333333333333333333333333333333333333333333\")\n                  console.log(res);\n\n                  if (String(res.data.code) === '1') {\n                    _this2.ruleForm = _objectSpread({}, res.data.data);\n                    _this2.ruleForm.price = String(res.data.data.price);\n                    _this2.ruleForm.status = res.data.data.status == '1';\n                    _this2.dishFlavors = res.data.data.flavors && res.data.data.flavors.map(function (obj) {\n                      return _objectSpread({}, obj, {\n                        value: JSON.parse(obj.value),\n                        showOption: false\n                      });\n                    });\n                    console.log('this.dishFlavors', _this2.dishFlavors); // this.ruleForm.id = res.data.data.categoryId\n                    // this.imageUrl = res.data.data.image\n\n                    _this2.imageUrl = \"/api/common/download?name=\".concat(res.data.data.image);\n                  } else {\n                    _this2.$message.error(res.data.msg || '操作失败');\n                  }\n                });\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    // 按钮 - 添加口味\n    addFlavore: function addFlavore() {\n      this.dishFlavors.push({\n        'name': '',\n        'value': [],\n        showOption: false\n      }); // JSON.parse(JSON.stringify(this.dishFlavorsData))\n    },\n    // 按钮 - 删除口味\n    delFlavor: function delFlavor(ind) {\n      this.dishFlavors.splice(ind, 1);\n    },\n    // 按钮 - 删除口味标签\n    delFlavorLabel: function delFlavorLabel(index, ind) {\n      this.dishFlavors[index].value.splice(ind, 1);\n    },\n    //口味位置记录\n    flavorPosition: function flavorPosition(index) {\n      this.index = index;\n    },\n    // 添加口味标签\n    keyDownHandle: function keyDownHandle(val, index) {\n      console.log('keyDownHandle----val', val);\n      console.log('keyDownHandle----index', index);\n      console.log('keyDownHandle----this.dishFlavors', this.dishFlavors);\n\n      if (event) {\n        event.cancelBubble = true;\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      if (val.target.innerText.trim() != '') {\n        this.dishFlavors[index].value.push(val.target.innerText);\n        val.target.innerText = '';\n      }\n    },\n    // 获取菜品分类\n    getDishList: function getDishList() {\n      var _this3 = this;\n\n      getCategoryList({\n        'type': 1\n      }).then(function (res) {\n        if (res.data.code === 1) {\n          _this3.dishList = res.data.data;\n        } else {\n          _this3.$message.error(res.data.msg || '操作失败');\n        }\n      });\n    },\n    // 获取口味列表\n    getFlavorListHand: function getFlavorListHand() {\n      // flavor flavorData\n      this.dishFlavorsData = [{\n        'name': '甜味',\n        'value': ['无糖', '少糖', '半糖', '多糖', '全糖']\n      }, {\n        'name': '温度',\n        'value': ['热饮', '常温', '去冰', '少冰', '多冰']\n      }, {\n        'name': '忌口',\n        'value': ['不要葱', '不要蒜', '不要香菜', '不要辣']\n      }, {\n        'name': '辣度',\n        'value': ['不辣', '微辣', '中辣', '重辣']\n      }];\n    },\n    selectFlavor: function selectFlavor(st, index) {\n      console.log('st', st);\n      console.log('index', index);\n      console.log('this.dishFlavors', this.dishFlavors);\n      var obj = JSON.parse(JSON.stringify(this.dishFlavors[index]));\n      obj.showOption = st;\n      this.dishFlavors.splice(index, 1, obj); // this.dishFlavors[index].showOption = st\n    },\n    outSelect: function outSelect(st, index) {\n      var _this = this;\n\n      setTimeout(function () {\n        var obj = JSON.parse(JSON.stringify(_this.dishFlavors[index]));\n        obj.showOption = st;\n\n        _this.dishFlavors.splice(index, 1, obj);\n      }, 200);\n    },\n    inputHandle: function inputHandle(val, index) {// this.selectFlavor(false,index)\n    },\n    checkOption: function checkOption(val, ind, index) {\n      this.selectHandle(val.name, index, ind);\n      this.dishFlavors[index].name = val.name;\n    },\n    selectHandle: function selectHandle(val, key, ind) {\n      var arrDate = _toConsumableArray(this.dishFlavors);\n\n      arrDate[key] = JSON.parse(JSON.stringify(this.dishFlavorsData[ind]));\n      this.dishFlavors = arrDate;\n    },\n    submitForm: function submitForm(formName, st) {\n      var _this4 = this;\n\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = _objectSpread({}, _this4.ruleForm); // params.flavors = this.dishFlavors\n\n\n          params.status = _this4.ruleForm ? 1 : 0; // params.price *= 100\n\n          params.categoryId = _this4.ruleForm.categoryId;\n          params.flavors = _this4.dishFlavors.map(function (obj) {\n            return _objectSpread({}, obj, {\n              value: JSON.stringify(obj.value)\n            });\n          });\n          delete params.dishFlavors;\n\n          if (!_this4.imageUrl) {\n            _this4.$message.error('请上传菜品图片');\n\n            return;\n          }\n\n          if (_this4.actionType == 'add') {\n            delete params.id;\n            addDish(params).then(function (res) {\n              if (res.data.code === 1) {\n                _this4.$message.success('菜品添加成功！');\n\n                if (!st) {\n                  _this4.goBack();\n                } else {\n                  _this4.dishFlavors = []; // this.dishFlavorsData = []\n\n                  _this4.imageUrl = '';\n                  _this4.ruleForm = {\n                    'name': '',\n                    'id': '',\n                    'price': '',\n                    'code': '',\n                    'image': '',\n                    'description': '',\n                    'dishFlavors': [],\n                    'status': true,\n                    categoryId: ''\n                  };\n                }\n              } else {\n                _this4.$message.error(res.data.msg || '操作失败');\n              }\n            }).catch(function (err) {\n              _this4.$message.error('请求出错了：' + err);\n            });\n          } else {\n            delete params.updateTime;\n            editDish(params).then(function (res) {\n              if (res.data.code === 1) {\n                _this4.$message.success('菜品修改成功！');\n\n                _this4.goBack();\n              } else {\n                _this4.$message.error(res.data.msg || '操作失败');\n              }\n            }).catch(function (err) {\n              _this4.$message.error('请求出错了：' + err);\n            });\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    handleAvatarSuccess: function handleAvatarSuccess(response, file, fileList) {\n      // 拼接down接口预览\n      if (response.code === 0 && response.msg === '未登录') {\n        window.top.location.href = '/backend/page/login/login.html';\n      } else {\n        this.imageUrl = \"/api/common/download?name=\".concat(response.data);\n        this.ruleForm.image = response.data;\n      }\n    },\n    onChange: function onChange(file) {\n      if (file) {\n        var suffix = file.name.split('.')[1];\n        var size = file.size / 1024 / 1024 < 2;\n\n        if (['png', 'jpeg', 'jpg'].indexOf(suffix) < 0) {\n          this.$message.error('上传图片只支持 png、jpeg、jpg 格式！');\n          this.$refs.upload.clearFiles();\n          return false;\n        }\n\n        if (!size) {\n          this.$message.error('上传文件大小不能超过 2MB!');\n          return false;\n        }\n\n        return file;\n      }\n    },\n    goBack: function goBack() {\n      this.$parent.goBackFlag = false; // this.$parent.menuActived='4';\n\n      console.log(this.$parent.menuActived);\n      this.$router.push('/food/list');\n    }\n  }\n};",{"version":3,"sources":["add.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"addBrand-container\" id=\"food-add-app\">\r\n\t\t<div class=\"container\" style=\"height:600px; overflow:auto\">\r\n\t\t\t<el-form ref=\"ruleForm\" :model=\"ruleForm\" :rules=\"rules\" :inline=\"true\" label-width=\"180px\"\r\n\t\t\t\tclass=\"demo-ruleForm\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div style=\"width: 90%; display: flex;margin: 0 auto;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品名称:\" prop=\"name\" style=\"width: 50%;\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.name\" placeholder=\"请填写菜品名称\" maxlength=\"20\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"菜品分类:\" prop=\"categoryId\" style=\"width: 50%;\">\r\n\t\t\t\t\t\t\t<el-select v-model=\"ruleForm.categoryId\" placeholder=\"请选择菜品分类\">\r\n\t\t\t\t\t\t\t\t<el-option v-for=\"(item,index) in dishList\" :key=\"index\" :label=\"item.name\"\r\n\t\t\t\t\t\t\t\t\t:value=\"item.id\" />\r\n\t\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div style=\"width: 90%;margin: 0 auto;display: flex;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品价格:\" prop=\"price\" style=\"width: 49%;\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.price\" placeholder=\"请设置菜品价格\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"width: 90%;margin: 0 auto;display: flex;\">\r\n\t\t\t\t\t<el-form-item label=\"口味做法配置:\" style=\"width: 49%;\">\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<div class=\"flavorBox\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"dishFlavors.length == 0\" class=\"addBut\" @click=\"addFlavore\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"float: left;\"> + 添加口味</span>\r\n\t\t\t\t\t\t\t\t<div v-if=\"dishFlavors.length != 0\" class=\"flavor\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"title\">\r\n\t\t\t\t\t\t\t\t\t\t<span>口味名（3个字内）</span><span>口味标签（输入标签回车添加）</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"cont\">\r\n\t\t\t\t\t\t\t\t\t\t<div v-for=\"(item, index) in dishFlavors\" :key=\"index\" class=\"items\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"itTit\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- <SelectInput\r\n\t\t\t\t\t            :dish-flavors-data=\"dishFlavorsData\"\r\n\t\t\t\t\t            :index=\"index\"\r\n\t\t\t\t\t            :value=\"item.name\"\r\n\t\t\t\t\t            @select=\"selectHandle\"\r\n\t\t\t\t\t          /> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"selectInput\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<el-input v-model=\"item.name\" type=\"text\" style=\"width: 100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入口味\" @focus=\"selectFlavor(true,index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@blur=\"outSelect(false,index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@input=\"inputHandle(index)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div v-show=\"item.showOption\" class=\"flavorSelect\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-for=\"(it, ind) in dishFlavorsData\" :key=\"ind\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"items\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"checkOption(it,ind,index)\">{{ it.name }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-if=\"dishFlavorsData == []\" class=\"none\">无数据</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"labItems\" style=\"display: flex\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-for=\"(it, ind) in item.value\" :key=\"ind\">{{ it }} <i\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"delFlavorLabel(index, ind)\">X</i></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"inputBox\" :style=\"inputStyle\" contenteditable=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@focus=\"flavorPosition(index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@keydown.enter=\"(val)=>keyDownHandle(val,index)\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"delFlavor delBut non\" @click=\"delFlavor(index)\">删除</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"addBut\" @click=\"addFlavore\">\r\n\t\t\t\t\t\t\t\t\t\t添加口味\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"width: 90%;display: flex;\">\r\n\t\t\t\t\t<div style=\"margin-right: auto;width: 60%;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品图片:\" prop=\"region\" class=\"uploadImg\">\r\n\t\t\t\t\t\t\t<el-upload class=\"avatar-uploader\" action=\"/api/common/upload\" :show-file-list=\"false\"\r\n\t\t\t\t\t\t\t\t:on-success=\"handleAvatarSuccess\" :on-change=\"onChange\" ref=\"upload\"\r\n\t\t\t\t\t\t\t\tstyle=\"float: left;\">\r\n\t\t\t\t\t\t\t\t<img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\"></img>\r\n\t\t\t\t\t\t\t\t<i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n\t\t\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"address\" style=\"width: 92%;display: flex;\">\r\n\t\t\t\t\t<div style=\"margin-right: auto;width: 100%;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品描述:\" prop=\"region\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.description\" type=\"textarea\" :rows=\"3\" placeholder=\"菜品描述，最长200字\"\r\n\t\t\t\t\t\t\t\tmaxlength=\"200\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"subBox address\">\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-button @click=\"goBack()\">\r\n\t\t\t\t\t\t\t取消\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('ruleForm')\">\r\n\t\t\t\t\t\t\t保存\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button v-if=\"actionType == 'add'\" type=\"primary\" class=\"continue\"\r\n\t\t\t\t\t\t\t@click=\"submitForm('ruleForm','goAnd')\">\r\n\t\t\t\t\t\t\t保存并继续添加菜品\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t</el-form>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tqueryDishById\r\n\t} from '../../api/food.js'\r\n\timport {\r\n\t\tgetCategoryList\r\n\t} from '../../api/food.js'\r\n\timport {\r\n\t\taddDish\r\n\t} from '../../api/food.js'\r\n\r\n\r\n\timport {\r\n\t\teditDish\r\n\t} from '../../api/food.js'\r\n\texport default {\r\n\t\tname: 'fadd',\r\n\t\tel: '#food-add-app',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: '',\r\n\t\t\t\trestKey: 0,\r\n\t\t\t\ttextarea: '',\r\n\t\t\t\tvalue: '',\r\n\t\t\t\timageUrl: '',\r\n\t\t\t\tactionType: '',\r\n\t\t\t\tdishList: [],\r\n\t\t\t\tdishFlavorsData: [],\r\n\t\t\t\tdishFlavors: [],\r\n\t\t\t\tvueRest: '1',\r\n\t\t\t\tindex: 0,\r\n\t\t\t\tinputStyle: {\r\n\t\t\t\t\t'flex': 1\r\n\t\t\t\t},\r\n\t\t\t\truleForm: {\r\n\t\t\t\t\t'name': '',\r\n\t\t\t\t\t'id': '',\r\n\t\t\t\t\t'price': '',\r\n\t\t\t\t\t'code': '',\r\n\t\t\t\t\t'image': '',\r\n\t\t\t\t\t'description': '',\r\n\t\t\t\t\t'dishFlavors': [],\r\n\t\t\t\t\t'status': true,\r\n\t\t\t\t\tcategoryId: ''\r\n\t\t\t\t},\r\n\t\t\t\tmak: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t\r\n\t\t\trules() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t'name': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t'message': '请填写菜品名称',\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\t'categoryId': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t'message': '请选择菜品分类',\r\n\t\t\t\t\t\t'trigger': 'change'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\t'price': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t// 'message': '请填写菜品价格',\r\n\t\t\t\t\t\tvalidator: (rules, value, callback) => {\r\n\t\t\t\t\t\t\tif (!value) {\r\n\t\t\t\t\t\t\t\tcallback(new Error('请填写菜品价格'))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconst reg = /^\\d+(\\.\\d{0,2})?$/\r\n\t\t\t\t\t\t\t\tif (reg.test(value)) {\r\n\t\t\t\t\t\t\t\t\tif (value < 10000) {\r\n\t\t\t\t\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tcallback(new Error('菜品价格小于10000'))\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tcallback(new Error('菜品价格格式只能为数字,且最多保留两位小数'))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.$parent.goBackFlag=true;\r\n\t\t\tthis.$parent.menuActived='4'\r\n\t\t\tthis.getDishList()\r\n\t\t\t// 口味临时数据\r\n\t\t\tthis.getFlavorListHand()\r\n\t\t\tthis.id = this.$route.params.id\r\n\t\t\tconsole.log(\"-----------------\")\r\n\t\t\tconsole.log(this.id)\r\n\t\t\tthis.actionType = this.id ? 'edit' : 'add'\r\n\t\t\tif (this.id) {\r\n\t\t\t\tthis.init()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {},\r\n\t\tmethods: {\r\n\t\t\tasync init() {\r\n\t\t\t\tqueryDishById(this.id).then(res => {\r\n\t\t\t\t\t// console.log(\"12333333333333333333333333333333333333333333333333333333333\")\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (String(res.data.code) === '1') {\r\n\t\t\t\t\t\tthis.ruleForm = {\r\n\t\t\t\t\t\t\t...res.data.data\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.ruleForm.price = String(res.data.data.price )\r\n\t\t\t\t\t\tthis.ruleForm.status = res.data.data.status == '1'\r\n\t\t\t\t\t\tthis.dishFlavors = res.data.data.flavors && res.data.data.flavors.map(obj => ({\r\n\t\t\t\t\t\t\t...obj,\r\n\t\t\t\t\t\t\tvalue: JSON.parse(obj.value),\r\n\t\t\t\t\t\t\tshowOption: false\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t\tconsole.log('this.dishFlavors', this.dishFlavors)\r\n\t\t\t\t\t\t// this.ruleForm.id = res.data.data.categoryId\r\n\t\t\t\t\t\t// this.imageUrl = res.data.data.image\r\n\t\t\t\t\t\tthis.imageUrl = `/api/common/download?name=${res.data.data.image}`\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 按钮 - 添加口味\r\n\t\t\taddFlavore() {\r\n\t\t\t\tthis.dishFlavors.push({\r\n\t\t\t\t\t'name': '',\r\n\t\t\t\t\t'value': [],\r\n\t\t\t\t\tshowOption: false\r\n\t\t\t\t}) // JSON.parse(JSON.stringify(this.dishFlavorsData))\r\n\t\t\t},\r\n\r\n\t\t\t// 按钮 - 删除口味\r\n\t\t\tdelFlavor(ind) {\r\n\t\t\t\tthis.dishFlavors.splice(ind, 1)\r\n\t\t\t},\r\n\r\n\t\t\t// 按钮 - 删除口味标签\r\n\t\t\tdelFlavorLabel(index, ind) {\r\n\t\t\t\tthis.dishFlavors[index].value.splice(ind, 1)\r\n\t\t\t},\r\n\r\n\t\t\t//口味位置记录\r\n\t\t\tflavorPosition(index) {\r\n\t\t\t\tthis.index = index\r\n\t\t\t},\r\n\r\n\t\t\t// 添加口味标签\r\n\t\t\tkeyDownHandle(val, index) {\r\n\t\t\t\tconsole.log('keyDownHandle----val', val)\r\n\t\t\t\tconsole.log('keyDownHandle----index', index)\r\n\t\t\t\tconsole.log('keyDownHandle----this.dishFlavors', this.dishFlavors)\r\n\t\t\t\tif (event) {\r\n\t\t\t\t\tevent.cancelBubble = true\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (val.target.innerText.trim() != '') {\r\n\t\t\t\t\tthis.dishFlavors[index].value.push(val.target.innerText)\r\n\t\t\t\t\tval.target.innerText = ''\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 获取菜品分类\r\n\t\t\tgetDishList() {\r\n\t\t\t\tgetCategoryList({\r\n\t\t\t\t\t'type': 1\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\tthis.dishList = res.data.data\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 获取口味列表\r\n\t\t\tgetFlavorListHand() {\r\n\t\t\t\t// flavor flavorData\r\n\t\t\t\tthis.dishFlavorsData = [{\r\n\t\t\t\t\t\t'name': '甜味',\r\n\t\t\t\t\t\t'value': ['无糖', '少糖', '半糖', '多糖', '全糖']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '温度',\r\n\t\t\t\t\t\t'value': ['热饮', '常温', '去冰', '少冰', '多冰']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '忌口',\r\n\t\t\t\t\t\t'value': ['不要葱', '不要蒜', '不要香菜', '不要辣']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '辣度',\r\n\t\t\t\t\t\t'value': ['不辣', '微辣', '中辣', '重辣']\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\r\n\t\t\tselectFlavor(st, index) {\r\n\t\t\t\tconsole.log('st', st)\r\n\t\t\t\tconsole.log('index', index)\r\n\t\t\t\tconsole.log('this.dishFlavors', this.dishFlavors)\r\n\t\t\t\tconst obj = JSON.parse(JSON.stringify(this.dishFlavors[index]))\r\n\t\t\t\tobj.showOption = st\r\n\t\t\t\tthis.dishFlavors.splice(index, 1, obj)\r\n\t\t\t\t// this.dishFlavors[index].showOption = st\r\n\t\t\t},\r\n\r\n\t\t\toutSelect(st, index) {\r\n\t\t\t\tconst _this = this\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tconst obj = JSON.parse(JSON.stringify(_this.dishFlavors[index]))\r\n\t\t\t\t\tobj.showOption = st\r\n\t\t\t\t\t_this.dishFlavors.splice(index, 1, obj)\r\n\t\t\t\t}, 200)\r\n\t\t\t},\r\n\r\n\t\t\tinputHandle(val, index) {\r\n\t\t\t\t// this.selectFlavor(false,index)\r\n\t\t\t},\r\n\r\n\t\t\tcheckOption(val, ind, index) {\r\n\t\t\t\tthis.selectHandle(val.name, index, ind)\r\n\t\t\t\tthis.dishFlavors[index].name = val.name\r\n\t\t\t},\r\n\r\n\t\t\tselectHandle(val, key, ind) {\r\n\t\t\t\tconst arrDate = [...this.dishFlavors]\r\n\t\t\t\tarrDate[key] = JSON.parse(JSON.stringify(this.dishFlavorsData[ind]))\r\n\t\t\t\tthis.dishFlavors = arrDate\r\n\t\t\t},\r\n\r\n\t\t\tsubmitForm(formName, st) {\r\n\t\t\t\tthis.$refs[formName].validate((valid) => {\r\n\t\t\t\t\tif (valid) {\r\n\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\t...this.ruleForm\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// params.flavors = this.dishFlavors\r\n\t\t\t\t\t\tparams.status = this.ruleForm ? 1 : 0\r\n\t\t\t\t\t\t// params.price *= 100\r\n\t\t\t\t\t\tparams.categoryId = this.ruleForm.categoryId\r\n\t\t\t\t\t\tparams.flavors = this.dishFlavors.map(obj => ({\r\n\t\t\t\t\t\t\t...obj,\r\n\t\t\t\t\t\t\tvalue: JSON.stringify(obj.value)\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t\tdelete params.dishFlavors\r\n\t\t\t\t\t\tif (!this.imageUrl) {\r\n\t\t\t\t\t\t\tthis.$message.error('请上传菜品图片')\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.actionType == 'add') {\r\n\t\t\t\t\t\t\tdelete params.id\r\n\t\t\t\t\t\t\taddDish(params).then(res => {\r\n\t\t\t\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\t\t\t\tthis.$message.success('菜品添加成功！')\r\n\t\t\t\t\t\t\t\t\tif (!st) {\r\n\t\t\t\t\t\t\t\t\t\tthis.goBack()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.dishFlavors = []\r\n\t\t\t\t\t\t\t\t\t\t// this.dishFlavorsData = []\r\n\t\t\t\t\t\t\t\t\t\tthis.imageUrl = ''\r\n\t\t\t\t\t\t\t\t\t\tthis.ruleForm = {\r\n\t\t\t\t\t\t\t\t\t\t\t'name': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'id': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'price': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'code': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'image': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'description': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'dishFlavors': [],\r\n\t\t\t\t\t\t\t\t\t\t\t'status': true,\r\n\t\t\t\t\t\t\t\t\t\t\tcategoryId: ''\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\tthis.$message.error('请求出错了：' + err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdelete params.updateTime\r\n\t\t\t\t\t\t\teditDish(params).then(res => {\r\n\t\t\t\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\t\t\t\tthis.$message.success('菜品修改成功！')\r\n\t\t\t\t\t\t\t\t\tthis.goBack()\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\tthis.$message.error('请求出错了：' + err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\thandleAvatarSuccess(response, file, fileList) {\r\n\t\t\t\t// 拼接down接口预览\r\n\t\t\t\tif (response.code === 0 && response.msg === '未登录') {\r\n\t\t\t\t\twindow.top.location.href = '/backend/page/login/login.html'\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.imageUrl = `/api/common/download?name=${response.data}`\r\n\t\t\t\t\tthis.ruleForm.image = response.data\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonChange(file) {\r\n\t\t\t\tif (file) {\r\n\t\t\t\t\tconst suffix = file.name.split('.')[1]\r\n\t\t\t\t\tconst size = file.size / 1024 / 1024 < 2\r\n\t\t\t\t\tif (['png', 'jpeg', 'jpg'].indexOf(suffix) < 0) {\r\n\t\t\t\t\t\tthis.$message.error('上传图片只支持 png、jpeg、jpg 格式！')\r\n\t\t\t\t\t\tthis.$refs.upload.clearFiles()\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!size) {\r\n\t\t\t\t\t\tthis.$message.error('上传文件大小不能超过 2MB!')\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn file\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgoBack() {\r\n\t\t\t\tthis.$parent.goBackFlag=false;\r\n\t\t\t\t// this.$parent.menuActived='4';\r\n\t\t\t\tconsole.log(this.$parent.menuActived)\r\n\t\t\t\tthis.$router.push('/food/list')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/* \t.selectInput {\r\n\t      position: relative;\r\n\t      width: 100%;\r\n\t      min-width: 100px;\r\n\t    }\r\n\t    .selectInput .flavorSelect {\r\n\t      position: absolute;\r\n\t      width: 100%;\r\n\t      padding: 0 10px;\r\n\t      border-radius: 3px;\r\n\t      border: solid 1px #FF903D;\r\n\t      line-height: 30px;\r\n\t      text-align: center;\r\n\t      background: #fff;\r\n\t      top: 50px;\r\n\t      z-index: 99;\r\n\t    }\r\n\t    .selectInput .flavorSelect .items {\r\n\t      cursor: pointer;\r\n\t      display: inline-block;\r\n\t      width: 100%;\r\n\t      line-height: 35px;\r\n\t      border-bottom: solid 1px #f4f4f4;\r\n\t      color: #666;\r\n\t    }\r\n\t    .selectInput .flavorSelect .none {\r\n\t      font-size: 14px;\r\n\t    }\r\n\t\r\n\t    #food-add-app .uploadImg .el-form-item__label::before{\r\n\t          content: '*';\r\n\t          color: #F56C6C;\r\n\t          margin-right: 4px;\r\n\t      } */\r\n</style>\n"],"sourceRoot":"src/components/food"}]}