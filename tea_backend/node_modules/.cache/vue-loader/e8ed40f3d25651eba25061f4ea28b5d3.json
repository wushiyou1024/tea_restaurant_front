{"remainingRequest":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\food\\add.vue?vue&type=style&index=0&id=626b1780&scoped=true&lang=css&","dependencies":[{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\food\\add.vue","mtime":1670920003115},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\css-loader\\index.js","mtime":1667713499694},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1667713514183},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\postcss-loader\\src\\index.js","mtime":1667713515690},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667713506232},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js","mtime":1667713514172}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* \t.selectInput {\n      position: relative;\n      width: 100%;\n      min-width: 100px;\n    }\n    .selectInput .flavorSelect {\n      position: absolute;\n      width: 100%;\n      padding: 0 10px;\n      border-radius: 3px;\n      border: solid 1px #FF903D;\n      line-height: 30px;\n      text-align: center;\n      background: #fff;\n      top: 50px;\n      z-index: 99;\n    }\n    .selectInput .flavorSelect .items {\n      cursor: pointer;\n      display: inline-block;\n      width: 100%;\n      line-height: 35px;\n      border-bottom: solid 1px #f4f4f4;\n      color: #666;\n    }\n    .selectInput .flavorSelect .none {\n      font-size: 14px;\n    }\n\n    #food-add-app .uploadImg .el-form-item__label::before{\n          content: '*';\n          color: #F56C6C;\n          margin-right: 4px;\n      } */\n",{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/components/food","sourcesContent":["<template>\r\n\t<div class=\"addBrand-container\" id=\"food-add-app\">\r\n\t\t<div class=\"container\" style=\"height:600px; overflow:auto\">\r\n\t\t\t<el-form ref=\"ruleForm\" :model=\"ruleForm\" :rules=\"rules\" :inline=\"true\" label-width=\"180px\"\r\n\t\t\t\tclass=\"demo-ruleForm\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div style=\"width: 90%; display: flex;margin: 0 auto;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品名称:\" prop=\"name\" style=\"width: 50%;\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.name\" placeholder=\"请填写菜品名称\" maxlength=\"20\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"菜品分类:\" prop=\"categoryId\" style=\"width: 50%;\">\r\n\t\t\t\t\t\t\t<el-select v-model=\"ruleForm.categoryId\" placeholder=\"请选择菜品分类\">\r\n\t\t\t\t\t\t\t\t<el-option v-for=\"(item,index) in dishList\" :key=\"index\" :label=\"item.name\"\r\n\t\t\t\t\t\t\t\t\t:value=\"item.id\" />\r\n\t\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div style=\"width: 90%;margin: 0 auto;display: flex;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品价格:\" prop=\"price\" style=\"width: 49%;\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.price\" placeholder=\"请设置菜品价格\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"width: 90%;margin: 0 auto;display: flex;\">\r\n\t\t\t\t\t<el-form-item label=\"口味做法配置:\" style=\"width: 49%;\">\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<div class=\"flavorBox\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"dishFlavors.length == 0\" class=\"addBut\" @click=\"addFlavore\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"float: left;\"> + 添加口味</span>\r\n\t\t\t\t\t\t\t\t<div v-if=\"dishFlavors.length != 0\" class=\"flavor\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"title\">\r\n\t\t\t\t\t\t\t\t\t\t<span>口味名（3个字内）</span><span>口味标签（输入标签回车添加）</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"cont\">\r\n\t\t\t\t\t\t\t\t\t\t<div v-for=\"(item, index) in dishFlavors\" :key=\"index\" class=\"items\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"itTit\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- <SelectInput\r\n\t\t\t\t\t            :dish-flavors-data=\"dishFlavorsData\"\r\n\t\t\t\t\t            :index=\"index\"\r\n\t\t\t\t\t            :value=\"item.name\"\r\n\t\t\t\t\t            @select=\"selectHandle\"\r\n\t\t\t\t\t          /> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"selectInput\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<el-input v-model=\"item.name\" type=\"text\" style=\"width: 100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入口味\" @focus=\"selectFlavor(true,index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@blur=\"outSelect(false,index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@input=\"inputHandle(index)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div v-show=\"item.showOption\" class=\"flavorSelect\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-for=\"(it, ind) in dishFlavorsData\" :key=\"ind\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"items\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"checkOption(it,ind,index)\">{{ it.name }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-if=\"dishFlavorsData == []\" class=\"none\">无数据</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"labItems\" style=\"display: flex\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-for=\"(it, ind) in item.value\" :key=\"ind\">{{ it }} <i\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"delFlavorLabel(index, ind)\">X</i></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"inputBox\" :style=\"inputStyle\" contenteditable=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@focus=\"flavorPosition(index)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@keydown.enter=\"(val)=>keyDownHandle(val,index)\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"delFlavor delBut non\" @click=\"delFlavor(index)\">删除</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"addBut\" @click=\"addFlavore\">\r\n\t\t\t\t\t\t\t\t\t\t添加口味\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"width: 90%;display: flex;\">\r\n\t\t\t\t\t<div style=\"margin-right: auto;width: 60%;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品图片:\" prop=\"region\" class=\"uploadImg\">\r\n\t\t\t\t\t\t\t<el-upload class=\"avatar-uploader\" action=\"/api/common/upload\" :show-file-list=\"false\"\r\n\t\t\t\t\t\t\t\t:on-success=\"handleAvatarSuccess\" :on-change=\"onChange\" ref=\"upload\"\r\n\t\t\t\t\t\t\t\tstyle=\"float: left;\">\r\n\t\t\t\t\t\t\t\t<img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\"></img>\r\n\t\t\t\t\t\t\t\t<i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n\t\t\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"address\" style=\"width: 92%;display: flex;\">\r\n\t\t\t\t\t<div style=\"margin-right: auto;width: 100%;\">\r\n\t\t\t\t\t\t<el-form-item label=\"菜品描述:\" prop=\"region\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.description\" type=\"textarea\" :rows=\"3\" placeholder=\"菜品描述，最长200字\"\r\n\t\t\t\t\t\t\t\tmaxlength=\"200\" />\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"subBox address\">\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-button @click=\"goBack()\">\r\n\t\t\t\t\t\t\t取消\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('ruleForm')\">\r\n\t\t\t\t\t\t\t保存\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button v-if=\"actionType == 'add'\" type=\"primary\" class=\"continue\"\r\n\t\t\t\t\t\t\t@click=\"submitForm('ruleForm','goAnd')\">\r\n\t\t\t\t\t\t\t保存并继续添加菜品\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t</el-form>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tqueryDishById\r\n\t} from '../../api/food.js'\r\n\timport {\r\n\t\tgetCategoryList\r\n\t} from '../../api/food.js'\r\n\timport {\r\n\t\taddDish\r\n\t} from '../../api/food.js'\r\n\r\n\r\n\timport {\r\n\t\teditDish\r\n\t} from '../../api/food.js'\r\n\texport default {\r\n\t\tname: 'fadd',\r\n\t\tel: '#food-add-app',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: '',\r\n\t\t\t\trestKey: 0,\r\n\t\t\t\ttextarea: '',\r\n\t\t\t\tvalue: '',\r\n\t\t\t\timageUrl: '',\r\n\t\t\t\tactionType: '',\r\n\t\t\t\tdishList: [],\r\n\t\t\t\tdishFlavorsData: [],\r\n\t\t\t\tdishFlavors: [],\r\n\t\t\t\tvueRest: '1',\r\n\t\t\t\tindex: 0,\r\n\t\t\t\tinputStyle: {\r\n\t\t\t\t\t'flex': 1\r\n\t\t\t\t},\r\n\t\t\t\truleForm: {\r\n\t\t\t\t\t'name': '',\r\n\t\t\t\t\t'id': '',\r\n\t\t\t\t\t'price': '',\r\n\t\t\t\t\t'code': '',\r\n\t\t\t\t\t'image': '',\r\n\t\t\t\t\t'description': '',\r\n\t\t\t\t\t'dishFlavors': [],\r\n\t\t\t\t\t'status': true,\r\n\t\t\t\t\tcategoryId: ''\r\n\t\t\t\t},\r\n\t\t\t\tmak: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t\r\n\t\t\trules() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t'name': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t'message': '请填写菜品名称',\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\t'categoryId': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t'message': '请选择菜品分类',\r\n\t\t\t\t\t\t'trigger': 'change'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\t'price': [{\r\n\t\t\t\t\t\t'required': true,\r\n\t\t\t\t\t\t// 'message': '请填写菜品价格',\r\n\t\t\t\t\t\tvalidator: (rules, value, callback) => {\r\n\t\t\t\t\t\t\tif (!value) {\r\n\t\t\t\t\t\t\t\tcallback(new Error('请填写菜品价格'))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconst reg = /^\\d+(\\.\\d{0,2})?$/\r\n\t\t\t\t\t\t\t\tif (reg.test(value)) {\r\n\t\t\t\t\t\t\t\t\tif (value < 10000) {\r\n\t\t\t\t\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tcallback(new Error('菜品价格小于10000'))\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tcallback(new Error('菜品价格格式只能为数字,且最多保留两位小数'))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.$parent.goBackFlag=true;\r\n\t\t\tthis.$parent.menuActived='4'\r\n\t\t\tthis.getDishList()\r\n\t\t\t// 口味临时数据\r\n\t\t\tthis.getFlavorListHand()\r\n\t\t\tthis.id = this.$route.params.id\r\n\t\t\tconsole.log(\"-----------------\")\r\n\t\t\tconsole.log(this.id)\r\n\t\t\tthis.actionType = this.id ? 'edit' : 'add'\r\n\t\t\tif (this.id) {\r\n\t\t\t\tthis.init()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {},\r\n\t\tmethods: {\r\n\t\t\tasync init() {\r\n\t\t\t\tqueryDishById(this.id).then(res => {\r\n\t\t\t\t\t// console.log(\"12333333333333333333333333333333333333333333333333333333333\")\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (String(res.data.code) === '1') {\r\n\t\t\t\t\t\tthis.ruleForm = {\r\n\t\t\t\t\t\t\t...res.data.data\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.ruleForm.price = String(res.data.data.price )\r\n\t\t\t\t\t\tthis.ruleForm.status = res.data.data.status == '1'\r\n\t\t\t\t\t\tthis.dishFlavors = res.data.data.flavors && res.data.data.flavors.map(obj => ({\r\n\t\t\t\t\t\t\t...obj,\r\n\t\t\t\t\t\t\tvalue: JSON.parse(obj.value),\r\n\t\t\t\t\t\t\tshowOption: false\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t\tconsole.log('this.dishFlavors', this.dishFlavors)\r\n\t\t\t\t\t\t// this.ruleForm.id = res.data.data.categoryId\r\n\t\t\t\t\t\t// this.imageUrl = res.data.data.image\r\n\t\t\t\t\t\tthis.imageUrl = `/api/common/download?name=${res.data.data.image}`\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 按钮 - 添加口味\r\n\t\t\taddFlavore() {\r\n\t\t\t\tthis.dishFlavors.push({\r\n\t\t\t\t\t'name': '',\r\n\t\t\t\t\t'value': [],\r\n\t\t\t\t\tshowOption: false\r\n\t\t\t\t}) // JSON.parse(JSON.stringify(this.dishFlavorsData))\r\n\t\t\t},\r\n\r\n\t\t\t// 按钮 - 删除口味\r\n\t\t\tdelFlavor(ind) {\r\n\t\t\t\tthis.dishFlavors.splice(ind, 1)\r\n\t\t\t},\r\n\r\n\t\t\t// 按钮 - 删除口味标签\r\n\t\t\tdelFlavorLabel(index, ind) {\r\n\t\t\t\tthis.dishFlavors[index].value.splice(ind, 1)\r\n\t\t\t},\r\n\r\n\t\t\t//口味位置记录\r\n\t\t\tflavorPosition(index) {\r\n\t\t\t\tthis.index = index\r\n\t\t\t},\r\n\r\n\t\t\t// 添加口味标签\r\n\t\t\tkeyDownHandle(val, index) {\r\n\t\t\t\tconsole.log('keyDownHandle----val', val)\r\n\t\t\t\tconsole.log('keyDownHandle----index', index)\r\n\t\t\t\tconsole.log('keyDownHandle----this.dishFlavors', this.dishFlavors)\r\n\t\t\t\tif (event) {\r\n\t\t\t\t\tevent.cancelBubble = true\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (val.target.innerText.trim() != '') {\r\n\t\t\t\t\tthis.dishFlavors[index].value.push(val.target.innerText)\r\n\t\t\t\t\tval.target.innerText = ''\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 获取菜品分类\r\n\t\t\tgetDishList() {\r\n\t\t\t\tgetCategoryList({\r\n\t\t\t\t\t'type': 1\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\tthis.dishList = res.data.data\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 获取口味列表\r\n\t\t\tgetFlavorListHand() {\r\n\t\t\t\t// flavor flavorData\r\n\t\t\t\tthis.dishFlavorsData = [{\r\n\t\t\t\t\t\t'name': '甜味',\r\n\t\t\t\t\t\t'value': ['无糖', '少糖', '半糖', '多糖', '全糖']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '温度',\r\n\t\t\t\t\t\t'value': ['热饮', '常温', '去冰', '少冰', '多冰']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '忌口',\r\n\t\t\t\t\t\t'value': ['不要葱', '不要蒜', '不要香菜', '不要辣']\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '辣度',\r\n\t\t\t\t\t\t'value': ['不辣', '微辣', '中辣', '重辣']\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\r\n\t\t\tselectFlavor(st, index) {\r\n\t\t\t\tconsole.log('st', st)\r\n\t\t\t\tconsole.log('index', index)\r\n\t\t\t\tconsole.log('this.dishFlavors', this.dishFlavors)\r\n\t\t\t\tconst obj = JSON.parse(JSON.stringify(this.dishFlavors[index]))\r\n\t\t\t\tobj.showOption = st\r\n\t\t\t\tthis.dishFlavors.splice(index, 1, obj)\r\n\t\t\t\t// this.dishFlavors[index].showOption = st\r\n\t\t\t},\r\n\r\n\t\t\toutSelect(st, index) {\r\n\t\t\t\tconst _this = this\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tconst obj = JSON.parse(JSON.stringify(_this.dishFlavors[index]))\r\n\t\t\t\t\tobj.showOption = st\r\n\t\t\t\t\t_this.dishFlavors.splice(index, 1, obj)\r\n\t\t\t\t}, 200)\r\n\t\t\t},\r\n\r\n\t\t\tinputHandle(val, index) {\r\n\t\t\t\t// this.selectFlavor(false,index)\r\n\t\t\t},\r\n\r\n\t\t\tcheckOption(val, ind, index) {\r\n\t\t\t\tthis.selectHandle(val.name, index, ind)\r\n\t\t\t\tthis.dishFlavors[index].name = val.name\r\n\t\t\t},\r\n\r\n\t\t\tselectHandle(val, key, ind) {\r\n\t\t\t\tconst arrDate = [...this.dishFlavors]\r\n\t\t\t\tarrDate[key] = JSON.parse(JSON.stringify(this.dishFlavorsData[ind]))\r\n\t\t\t\tthis.dishFlavors = arrDate\r\n\t\t\t},\r\n\r\n\t\t\tsubmitForm(formName, st) {\r\n\t\t\t\tthis.$refs[formName].validate((valid) => {\r\n\t\t\t\t\tif (valid) {\r\n\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\t...this.ruleForm\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// params.flavors = this.dishFlavors\r\n\t\t\t\t\t\tparams.status = this.ruleForm ? 1 : 0\r\n\t\t\t\t\t\t// params.price *= 100\r\n\t\t\t\t\t\tparams.categoryId = this.ruleForm.categoryId\r\n\t\t\t\t\t\tparams.flavors = this.dishFlavors.map(obj => ({\r\n\t\t\t\t\t\t\t...obj,\r\n\t\t\t\t\t\t\tvalue: JSON.stringify(obj.value)\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t\tdelete params.dishFlavors\r\n\t\t\t\t\t\tif (!this.imageUrl) {\r\n\t\t\t\t\t\t\tthis.$message.error('请上传菜品图片')\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.actionType == 'add') {\r\n\t\t\t\t\t\t\tdelete params.id\r\n\t\t\t\t\t\t\taddDish(params).then(res => {\r\n\t\t\t\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\t\t\t\tthis.$message.success('菜品添加成功！')\r\n\t\t\t\t\t\t\t\t\tif (!st) {\r\n\t\t\t\t\t\t\t\t\t\tthis.goBack()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.dishFlavors = []\r\n\t\t\t\t\t\t\t\t\t\t// this.dishFlavorsData = []\r\n\t\t\t\t\t\t\t\t\t\tthis.imageUrl = ''\r\n\t\t\t\t\t\t\t\t\t\tthis.ruleForm = {\r\n\t\t\t\t\t\t\t\t\t\t\t'name': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'id': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'price': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'code': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'image': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'description': '',\r\n\t\t\t\t\t\t\t\t\t\t\t'dishFlavors': [],\r\n\t\t\t\t\t\t\t\t\t\t\t'status': true,\r\n\t\t\t\t\t\t\t\t\t\t\tcategoryId: ''\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\tthis.$message.error('请求出错了：' + err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdelete params.updateTime\r\n\t\t\t\t\t\t\teditDish(params).then(res => {\r\n\t\t\t\t\t\t\t\tif (res.data.code === 1) {\r\n\t\t\t\t\t\t\t\t\tthis.$message.success('菜品修改成功！')\r\n\t\t\t\t\t\t\t\t\tthis.goBack()\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$message.error(res.data.msg || '操作失败')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\tthis.$message.error('请求出错了：' + err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\thandleAvatarSuccess(response, file, fileList) {\r\n\t\t\t\t// 拼接down接口预览\r\n\t\t\t\tif (response.code === 0 && response.msg === '未登录') {\r\n\t\t\t\t\twindow.top.location.href = '/backend/page/login/login.html'\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.imageUrl = `/api/common/download?name=${response.data}`\r\n\t\t\t\t\tthis.ruleForm.image = response.data\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonChange(file) {\r\n\t\t\t\tif (file) {\r\n\t\t\t\t\tconst suffix = file.name.split('.')[1]\r\n\t\t\t\t\tconst size = file.size / 1024 / 1024 < 2\r\n\t\t\t\t\tif (['png', 'jpeg', 'jpg'].indexOf(suffix) < 0) {\r\n\t\t\t\t\t\tthis.$message.error('上传图片只支持 png、jpeg、jpg 格式！')\r\n\t\t\t\t\t\tthis.$refs.upload.clearFiles()\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!size) {\r\n\t\t\t\t\t\tthis.$message.error('上传文件大小不能超过 2MB!')\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn file\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgoBack() {\r\n\t\t\t\tthis.$parent.goBackFlag=false;\r\n\t\t\t\t// this.$parent.menuActived='4';\r\n\t\t\t\tconsole.log(this.$parent.menuActived)\r\n\t\t\t\tthis.$router.push('/food/list')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/* \t.selectInput {\r\n\t      position: relative;\r\n\t      width: 100%;\r\n\t      min-width: 100px;\r\n\t    }\r\n\t    .selectInput .flavorSelect {\r\n\t      position: absolute;\r\n\t      width: 100%;\r\n\t      padding: 0 10px;\r\n\t      border-radius: 3px;\r\n\t      border: solid 1px #FF903D;\r\n\t      line-height: 30px;\r\n\t      text-align: center;\r\n\t      background: #fff;\r\n\t      top: 50px;\r\n\t      z-index: 99;\r\n\t    }\r\n\t    .selectInput .flavorSelect .items {\r\n\t      cursor: pointer;\r\n\t      display: inline-block;\r\n\t      width: 100%;\r\n\t      line-height: 35px;\r\n\t      border-bottom: solid 1px #f4f4f4;\r\n\t      color: #666;\r\n\t    }\r\n\t    .selectInput .flavorSelect .none {\r\n\t      font-size: 14px;\r\n\t    }\r\n\t\r\n\t    #food-add-app .uploadImg .el-form-item__label::before{\r\n\t          content: '*';\r\n\t          color: #F56C6C;\r\n\t          margin-right: 4px;\r\n\t      } */\r\n</style>\n"]}]}